{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swipekart</title>
<link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">    
<!-- Bootstrap icon cdn-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" integrity="sha384-tViUnnbYAV00FLIhhi3v/dWt3Jxw4gZQcNoSCxCIFNJVCx7/D55/wXsrNIRANwdD" crossorigin="anonymous">
      <!--icon -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!--Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="{% static 'js/script.js' %}"></script>  
     <style>
       /* dashboard starts */
.navbar{
    background-color: #7c0472;
    position: sticky;
    z-index: 1000;
    top: 0%;
    overflow: hidden;
  }
  .navbar-nav{
    font-size: 1rem;
  }
  .nav-link{
    color: #000000;
  }
  .nav-link:hover{
    color: #3c00ff;
  }
  #top_items{
    position: relative;
    background-color: #ffffff;
    
  }
  .outer_box{
    background-color: rgb(243, 243, 243);
    box-sizing: border-box;
    box-shadow: 20px black;
    padding: 10px;
  }
  .image_frame{
    display: block;
    width: 150px;
    height:150px;
    margin: 5px auto 0px auto;
  }
  .fa-solid{
    color: blue;
    cursor: pointer;
    float: right;
    margin-right: 15px;
  }
  #mob_card{
    position: static;
    border-color:rgb(0, 199, 0);
    text-align: center;
    font-weight: bold;
  }
  #mob_card:hover{
    transition: 0.2s;
    transform: scale(1.05);
    /* transform: translateY(-1.5%); */
    border-color: blue;
    /* box-shadow: 5px 5px 10px #888888; */
    box-shadow: 0 5px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
  }
  .carousel-inner{
position:inherit;
  }
  /* Dropdown Button */
.dropbtn {
  text-align: center;
  color: #1525d4;
  padding: 5px;
  font-size: 16px;
  border: none;
}

/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

/* Links inside the dropdown */
.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #dbdbdb;}

/* Show the dropdown menu on hover */
.dropdown:hover .dropdown-content {display: block;}

/* Change the background color of the dropdown button when the dropdown content is shown */
.dropdown:hover .dropbtn {
  background-color: #a0a0a0;
}
/* Dashboard ends */

        .submitted {
            border-color: #198754 !important;
        }
        .star {
            font-size: 30px;
            color: grey;
            cursor: pointer;
        }
        .selected {
            color: orange;
        }
        
        .chatbox {
      width: 400px;
      max-height: 500px;
      overflow-y: auto;
      border: 2px solid #ccc;
      border-radius: 10px;
      padding: 15px;
      background: #fff;
      margin-bottom: 10px;
    }
    .chat {
      margin: 10px 0;
    }
    .bot {
      color: #0033cc;
    }
    .user {
      color: #008800;
      text-align: right;
    }
    input[type="text"] {
      width: 300px;
      padding: 10px;
      font-size: 16px;
    }
    button {
      padding: 10px;
      font-size: 16px;
    }
    </style>
  </head>
<body>
     <!--navigation bar-->
   <nav class="navbar navbar-expand-lg navbar-dark ">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"  data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-right mx-5" id="navbarNav">
        <a href="{% url 'dashboard' %}"><img src="{% static 'images/ecom logo.png' %}"class="ms-5" style="height: 30px; width: 100px;"></a>
        <ul class="navbar-nav">
              <form class="d-flex" role="search">
                <input class="form-control me-3" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-primary ms-1" type="submit">Search</button>
              </form>
            </ul>
           <!-- <li class="nav-item"><a class="nav-link" href="#">Login</a> -->
            <div class="container">
                <i style="color: rgb(255, 255, 255);" class="fa-solid fa-user text-lowercase"><h6>{{ request.user.first_name }}!</h6></i>
                <i class="bi bi-cart4" style="color: yellow; cursor: pointer;"><a href="{% url 'view_cart' %}" class="btn btn-outline-primary">View Cart</a></i>
                <a href="{% url 'logout' %}" class="btn btn-success">Logout</a>
                
            </div>
        
    </div>
    </nav>
   <!--Navigation Ends--> 

<main>
    {% block content %}
    
    
    {% endblock %}
</main>

<!-- footer starts -->
<div class="container-fluid mt-5">
    <!-- Footer -->
    <footer class="text-center text-lg-start text-white" style="background-color: #2a2a2a">
      <!-- Grid container -->
      <div class="container p-5 pb-0">
        <!-- Section: Links -->
        <section class="">
          <!--Grid row-->
          <div class="row">
            <!-- Grid column -->
            <div class="col-md-3 col-lg-3 col-xl-3 mx-auto mt-3">
              <!-- <h6 class="mb-4 font-weight-bold">
                Swipekart
              </h6> -->
              <img src="{% static 'images/ecom logo.png' %}" alt="Company Logo" width="100">
              <p>Swipekart is a worldwide e-commerce platform where you can buy anything and everything with an affordable prices</p>
            </div>
            <!-- Grid column -->
            <hr class="w-100 clearfix d-md-none" />
            <!-- Grid column -->
            <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mt-3">
              <h6 class="text-uppercase mb-4 font-weight-bold">Services</h6>
              <p>
                <a class="text-white" href="#" data-bs-toggle="modal" data-bs-target="#staticBackdrop">Customer Support</a>
              </p>
              <p>
                <a class="text-white">Track delivery</a>
              </p>
              <p>
                <a class="text-white" href="#" data-bs-toggle="modal" data-bs-target="#conmod">Your Queries</a>
              </p>
              <p>
                <a class="text-white" href="{% url 'feedback_form' %}">Feedback</a>
              </p>
            </div>
            <!-- Grid column -->
            <hr class="w-100 clearfix d-md-none" />
            <!-- Grid column -->
            <hr class="w-100 clearfix d-md-none" />
            <!-- Grid column -->
            <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mt-3">
              <h6 class="text-uppercase mb-4 font-weight-bold">Contact</h6>
              <p><i class="bi bi-geo-alt-fill"></i>Chennai, TN</p>
              <p><i class="fas fa-envelope mr-3"></i> Swipekartinfo@gmail.com</p>
              <p><i class="fas fa-phone mr-3"></i> + 01 234 567 88</p>
              <p><i class="fas fa-print mr-3"></i> + 01 234 567 89</p>
            </div>
            <!-- Grid column -->
            <!-- Grid column -->
            <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mt-3">
              <h6 class="text-uppercase mb-4 font-weight-bold">Follow us</h6>
              <!-- Facebook -->
              <a class="btn btn-primary btn-floating m-1" style="background-color: #55acee" href="#!" role="button"><i class="fab fa-facebook-f"></i></a>
              <!-- Twitter -->
              <a class="btn btn-primary btn-floating m-1" style="background-color: #55acee" href="#!" role="button"><i class="fab fa-twitter"></i></a>
              <!-- Google -->
              <a class="btn btn-primary btn-floating m-1" style="background-color: #dd4b39" href="#!" role="button" ><i class="fab fa-google"></i></a>
              <!-- Instagram -->
              <a class="btn btn-primary btn-floating m-1" style="background-color: #ac2bac" href="#!" role="button"><i class="fab fa-instagram"></i ></a>
              <!-- Linkedin -->
              <a class="btn btn-primary btn-floating m-1" style="background-color: #0082ca" href="#!" role="button"><i class="fab fa-linkedin-in"></i></a>
              <!-- Github -->
              <a class="btn btn-primary btn-floating m-1" style="background-color: #333333" href="#!" role="button"><i class="fab fa-github"></i></a>
            </div>

            <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mt-3">
              <h6 class="text-uppercase mb-4 font-weight-bold">Chat Support</h6>
              <a class="btn btn-primary btn-floating m-4" style="background-color: #290aed;" href="{% url 'chatbox' %}" role="button"><i class="bi bi-chat-right-text"></i></a>
            </div>

          </div>
          <!--Grid row-->
        </section>
        <!-- Section: Links -->
      </div>
      <!-- Grid container -->
  
      <!-- Copyright -->
      <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2)"> &copy;2025 Copyright:
        <a class="text-white" href="index-1.html">Swipekart.com</a>
      </div>
      <!-- Copyright -->
    </footer>
    <!-- Footer -->
  </div>
  
  <!-- Footer ends -->
</body>
<script>
  let username = "";
    let initialized = false;

    function appendMessage(sender, message) {
      const chatbox = document.getElementById("chatbox");
      const messageDiv = document.createElement("div");
      messageDiv.className = `chat ${sender}`;
      messageDiv.textContent = `${sender === "bot" ? "ðŸ¤– Chatbot" : username}: ${message}`;
      chatbox.appendChild(messageDiv);
      chatbox.scrollTop = chatbox.scrollHeight;
    }

    function handleUserInput() {
      const inputField = document.getElementById("userInput");
      const userText = inputField.value.trim();
      if (userText === "") return;

      inputField.value = "";
      appendMessage("user", userText);

      if (!initialized) {
        username = userText;
        initialized = true;
        appendMessage("bot", `Hi ${username}, how can I assist you today?`);
        appendMessage("bot", "You can ask about categories, offers, track order, or say help.");
        return;
      }

      const lowerText = userText.toLowerCase();

      if (lowerText.includes("category") || lowerText.includes("categories")) {
        appendMessage("bot", "We have the following categories: Electronics, Fashion, Home, Books. What are you interested in?");
      } else if (lowerText.includes("electronics")) {
        appendMessage("bot", "Great choice! We have phones, laptops, TVs and more. Visit: /category/electronics");
      } else if (lowerText.includes("fashion")) {
        appendMessage("bot", "Fashion for all! Men, Women, Kids. Visit: /category/fashion");
      } else if (lowerText.includes("track") || lowerText.includes("order")) {
        appendMessage("bot", "Please enter your order ID to track it.");
      } else if (lowerText.match(/^#\d{5,}$/)) {
        appendMessage("bot", `Tracking order ${userText}... It is currently in transit ðŸšš.`);
      } else if (lowerText.includes("offer") || lowerText.includes("deal")) {
        appendMessage("bot", "ðŸ”¥ Today's top deals: 50% off on select electronics. Visit: /deals");
      } else if (lowerText === "help") {
        appendMessage("bot", "I can help you browse products, track orders, and find deals. Just type your query.");
      } else if (lowerText === "bye") {
        appendMessage("bot", `Goodbye, ${username}! Thanks for shopping at SwipeKart ðŸ›ï¸`);
        document.getElementById("userInput").disabled = true;
      } else {
        appendMessage("bot", "I'm not sure how to help with that. Try asking about categories, orders, or deals.");
      }
    };
  // feedback starts
    const stars = document.querySelectorAll('.star');
    const ratingInput = document.getElementById('rating');
    const ratingDesc = document.getElementById('ratingDesc');
    const submitBtn = document.getElementById('submitBtn');

    const ratingText = {
        1: "Poor",
        2: "Average",
        3: "Good",
        4: "Very Good",
        5: "Excellent"
    };

    stars.forEach(star => {
        star.addEventListener('click', function () {
            let rating = this.getAttribute('data-value');
            ratingInput.value = rating;
            stars.forEach(s => s.classList.remove('selected'));
            for (let i = 0; i < rating; i++) {
                stars[i].classList.add('selected');
            }
            ratingDesc.innerText = rating + " Star - " + ratingText[rating];
        });
    });

    document.getElementById('feedback_Form').addEventListener('submit', function (e) {
        e.preventDefault();
        fetch('', {
            method: 'POST',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}',
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: new URLSearchParams(new FormData(this))
        }).then(res => res.json())
          .then(data => {
            alert(data.message + " Welcome!");
            document.body.classList.add('submitted');
            submitBtn.classList.replace('btn-primary', 'btn-success');
        });
    });

    // chatbot
    
</script>
</html>