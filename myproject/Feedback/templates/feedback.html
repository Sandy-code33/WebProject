{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <style>
        body {
            border: 2px solid #0d6efd;
            padding: 20px;
        }
        .submitted {
            border-color: #198754 !important;
        }
        .star {
            font-size: 30px;
            color: grey;
            cursor: pointer;
        }
        .selected {
            color: orange;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="text-center mb-4">Feedback Form</h2>
        <form method="POST" id="feedbackForm">
            <div class="mb-3">
                <label class="form-label">Rate our Service:</label><br>
                <span class="star" data-value="1">&#9733;</span>
                <span class="star" data-value="2">&#9733;</span>
                <span class="star" data-value="3">&#9733;</span>
                <span class="star" data-value="4">&#9733;</span>
                <span class="star" data-value="5">&#9733;</span>
                <div id="ratingDesc" class="mt-2 text-primary fw-bold"></div>
                <input type="hidden" name="rating" id="rating">
            </div>
            <div class="mb-3">
                <label for="remark" class="form-label">Remarks:</label>
                <textarea class="form-control" id="remark" name="remark" rows="3" required></textarea>
            </div>
            <button type="submit" id="submitBtn" class="btn btn-primary">Submit</button>
        </form>
        <footer class="mt-5 d-flex justify-content-between">
            <div><img src="{% static 'ecom logo.png' %}" alt="Company Logo" width="100"></div>
            <div class="fw-bold">Helpdesk: +91-9600794837</div>
        </footer>
      </div>
</body>
<script>
    const stars = document.querySelectorAll('.star');
    const ratingInput = document.getElementById('rating');
    const ratingDesc = document.getElementById('ratingDesc');
    const submitBtn = document.getElementById('submitBtn');

    const ratingText = {
        1: "Poor",
        2: "Average",
        3: "Good",
        4: "Very Good",
        5: "Excellent"
    };

    stars.forEach(star => {
        star.addEventListener('click', function () {
            let rating = this.getAttribute('data-value');
            ratingInput.value = rating;
            stars.forEach(s => s.classList.remove('selected'));
            for (let i = 0; i < rating; i++) {
                stars[i].classList.add('selected');
            }
            ratingDesc.innerText = rating + " Star - " + ratingText[rating];
        });
    });

    document.getElementById('feedbackForm').addEventListener('submit', function (e) {
        e.preventDefault();
        fetch('', {
            method: 'POST',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}',
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: new URLSearchParams(new FormData(this))
        }).then(res => res.json())
          .then(data => {
            alert(data.message + " Welcome!");
            document.body.classList.add('submitted');
            submitBtn.classList.replace('btn-primary', 'btn-success');
        });
    });

</script>
</html>